"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[346],{346:function(e,a,n){n.r(a),n(3696);var t=n(1445);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},o.apply(this,arguments)}function s(e){let{components:a,...n}=e;return(0,t.yg)("wrapper",o({components:a},n),(0,t.yg)("div",{align:"center"}),(0,t.yg)("p",null,(0,t.yg)("a",{href:"https://npmjs.com/package/thread-loader",parentName:"p"},(0,t.yg)("img",{src:"https://img.shields.io/npm/v/thread-loader.svg",alt:"npm",parentName:"a"})),"\n",(0,t.yg)("a",{href:"https://nodejs.org",parentName:"p"},(0,t.yg)("img",{src:"https://img.shields.io/node/v/thread-loader.svg",alt:"node",parentName:"a"})),"\n",(0,t.yg)("a",{href:"https://github.com/webpack-contrib/thread-loader/actions",parentName:"p"},(0,t.yg)("img",{src:"https://github.com/webpack-contrib/thread-loader/workflows/thread-loader/badge.svg",alt:"tests",parentName:"a"})),"\n",(0,t.yg)("a",{href:"https://codecov.io/gh/webpack-contrib/thread-loader",parentName:"p"},(0,t.yg)("img",{src:"https://codecov.io/gh/webpack-contrib/thread-loader/branch/master/graph/badge.svg",alt:"coverage",parentName:"a"})),"\n",(0,t.yg)("a",{href:"https://github.com/webpack/webpack/discussions",parentName:"p"},(0,t.yg)("img",{src:"https://img.shields.io/github/discussions/webpack/webpack",alt:"discussion",parentName:"a"})),"\n",(0,t.yg)("a",{href:"https://packagephobia.now.sh/result?p=thread-loader",parentName:"p"},(0,t.yg)("img",{src:"https://packagephobia.now.sh/badge?p=thread-loader",alt:"size",parentName:"a"}))),(0,t.yg)("p",null,"Runs the following loaders in a worker pool."),(0,t.yg)("h2",null,(0,t.yg)("span",{id:"getting-started",parentName:"h2"}),"Getting Started",(0,t.yg)("a",{href:"#getting-started","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.yg)("span",{className:"header-link",parentName:"a"}))),(0,t.yg)("pre",null,(0,t.yg)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.yg)("span",{className:"token function",parentName:"code"},"npm")," ",(0,t.yg)("span",{className:"token function",parentName:"code"},"install")," --save-dev thread-loader")),(0,t.yg)("p",null,"or"),(0,t.yg)("pre",null,(0,t.yg)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.yg)("span",{className:"token function",parentName:"code"},"yarn")," ",(0,t.yg)("span",{className:"token function",parentName:"code"},"add")," -D thread-loader")),(0,t.yg)("p",null,"or"),(0,t.yg)("pre",null,(0,t.yg)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.yg)("span",{className:"token function",parentName:"code"},"pnpm")," ",(0,t.yg)("span",{className:"token function",parentName:"code"},"add")," -D thread-loader")),(0,t.yg)("p",null,"Put this loader in front of other loaders. The following loaders run in a worker pool."),(0,t.yg)("p",null,"Loaders running in a worker pool are limited. Examples:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Loaders cannot emit files."),(0,t.yg)("li",{parentName:"ul"},"Loaders cannot use custom loader API (i. e. by plugins)."),(0,t.yg)("li",{parentName:"ul"},"Loaders cannot access the webpack options.")),(0,t.yg)("p",null,"Each worker is a separate node.js process, which has an overhead of ~600ms. There is also an overhead of inter-process communication."),(0,t.yg)("p",null,"Use this loader only for expensive operations!"),(0,t.yg)("h3",null,(0,t.yg)("span",{id:"examples",parentName:"h3"}),"Examples",(0,t.yg)("a",{href:"#examples","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.yg)("span",{className:"header-link",parentName:"a"}))),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"webpack.config.js")),(0,t.yg)("pre",null,(0,t.yg)("code",{className:"hljs language-js",parentName:"pre"},"module",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.yg)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  module",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    rules",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        test",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token regex",parentName:"code"},"/\\.js$/"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n        include",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," path",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.yg)("span",{className:"token function",parentName:"code"},"resolve"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.yg)("span",{className:"token string",parentName:"code"},"'src'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n        use",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"["),"\n          ",(0,t.yg)("span",{className:"token string",parentName:"code"},"'thread-loader'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n          ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// your expensive loader (e.g babel-loader)"),"\n        ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"with options")),(0,t.yg)("pre",null,(0,t.yg)("code",{className:"hljs language-js",parentName:"pre"},"use",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"["),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    loader",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token string",parentName:"code"},"'thread-loader'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// loaders with equal options will share worker pools"),"\n    options",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// the number of spawned workers, defaults to (number of cpus - 1) or"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// fallback to 1 when require('os').cpus() is undefined"),"\n      workers",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token number",parentName:"code"},"2"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// number of jobs a worker processes in parallel"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// defaults to 20"),"\n      workerParallelJobs",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token number",parentName:"code"},"50"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// additional node.js arguments"),"\n      workerNodeArgs",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.yg)("span",{className:"token string",parentName:"code"},"'--max-old-space-size=1024'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// Allow to respawn a dead worker pool"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// respawning slows down the entire compilation"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// and should be set to false for development"),"\n      poolRespawn",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token boolean",parentName:"code"},"false"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// timeout for killing the worker processes when idle"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// defaults to 500 (ms)"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// can be set to Infinity for watching builds to keep workers alive"),"\n      poolTimeout",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token number",parentName:"code"},"2000"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// number of jobs the poll distributes to the workers"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// defaults to 200"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// decrease of less efficient but more fair distribution"),"\n      poolParallelJobs",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token number",parentName:"code"},"50"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// name of the pool"),"\n      ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// can be used to create different pools with elsewise identical options"),"\n      name",(0,t.yg)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.yg)("span",{className:"token string",parentName:"code"},"'my-pool'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// your expensive loader (e.g babel-loader)"),"\n",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"prewarming")),(0,t.yg)("p",null,"To prevent the high delay when booting workers it possible to warmup the worker pool."),(0,t.yg)("p",null,"This boots the max number of workers in the pool and loads specified modules into the node.js module cache."),(0,t.yg)("pre",null,(0,t.yg)("code",{className:"hljs language-js",parentName:"pre"},(0,t.yg)("span",{className:"token keyword",parentName:"code"},"const")," threadLoader ",(0,t.yg)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.yg)("span",{className:"token function",parentName:"code"},"require"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.yg)("span",{className:"token string",parentName:"code"},"'thread-loader'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nthreadLoader",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.yg)("span",{className:"token function",parentName:"code"},"warmup"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"("),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// pool options, like passed to loader options"),"\n    ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// must match loader options to boot the correct pool"),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// modules to load"),"\n    ",(0,t.yg)("span",{className:"token comment",parentName:"code"},"// can be any module, i. e."),"\n    ",(0,t.yg)("span",{className:"token string",parentName:"code"},"'babel-loader'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.yg)("span",{className:"token string",parentName:"code"},"'babel-preset-es2015'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.yg)("span",{className:"token string",parentName:"code"},"'sass-loader'"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},"]"),"\n",(0,t.yg)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.yg)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.yg)("h2",null,(0,t.yg)("span",{id:"contributing",parentName:"h2"}),"Contributing",(0,t.yg)("a",{href:"#contributing","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.yg)("span",{className:"header-link",parentName:"a"}))),(0,t.yg)("p",null,"Please take a moment to read our contributing guidelines if you haven't yet done so."),(0,t.yg)("p",null,(0,t.yg)("a",{href:"https://github.com/webpack-contrib/thread-loader/blob/master/.github/CONTRIBUTING.md",parentName:"p"},"CONTRIBUTING")),(0,t.yg)("h2",null,(0,t.yg)("span",{id:"license",parentName:"h2"}),"License",(0,t.yg)("a",{href:"#license","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.yg)("span",{className:"header-link",parentName:"a"}))),(0,t.yg)("p",null,(0,t.yg)("a",{href:"https://github.com/webpack-contrib/thread-loader/blob/master/LICENSE",parentName:"p"},"MIT")))}s.isMDXComponent=!0,a.default=s}}]);